const artifacts = {
    tut: {
        en: { 
            title: "Tutankhamun's Golden Mask", 
            desc: "The golden mask of Tutankhamun is a masterpiece of ancient Egyptian craftsmanship, discovered by Howard Carter in 1922. It was found resting directly on the shoulders of the boy king's mummy within the third coffin. Crafted from over 10 kilograms of solid gold, it is inlaid with semi-precious stones including lapis lazuli, carnelian, and turquoise. The mask depicts the Pharaoh wearing the Nemes headdress, topped by the royal insignia of the cobra and vulture. These symbols represent the unification of Lower and Upper Egypt. On the back of the mask, a protective spell from the 'Book of the Dead' is inscribed in hieroglyphs. This spell was intended to safeguard the king's physical form in the afterlife. The idealized features of the mask capture a sense of eternal youth and divinity. Today, it stands as the most iconic symbol of the Grand Egyptian Museum. Scholars continue to study the mask to understand the sophisticated metallurgical techniques of the 18th Dynasty.", 
            fact: "Made of 22-karat gold, weighing 10.23 kg.", 
            loc: "Tutankhamun Gallery (Level 2)", 
            image: "assets/tut_mask.jpg" 
        },
        ar: { 
            title: "قناع توت عنخ آمون الذهبي", 
            desc: "يعد قناع توت عنخ آمون الذهبي تحفة فنية من الحرفية المصرية القديمة، اكتشفه هوارد كارتر عام 1922. وُجد القناع مستقراً مباشرة على أكتاف مومياء الملك الشاب داخل التابوت الثالث. صُنع من أكثر من 10 كيلوغرامات من الذهب الخالص، وهو مطعم بالأحجار شبه الكريمة بما في ذلك اللازورد والعقيق والفيروز. يصور القناع الفرعون مرتديًا غطاء الرأس النمس، وتلوه الشارات الملكية للكوبرا والنسر. تمثل هذه الرموز توحيد مصر العليا والسفلى. نُقشت على ظهر القناع تعويذة وقائية من 'كتاب الموتى' بالخط الهيروغليفي. كان الهدف من هذه التعويذة حماية جسد الملك في الحياة الآخرة. تصور ملامح القناع المثالية إحساساً بالشباب الأبدي والألوهية. اليوم، يقف كأبرز رمز للمتحف المصري الكبير. يواصل العلماء دراسة القناع لفهم تقنيات قولبة المعادن المتطورة في الأسرة الثامنة عشرة.", 
            fact: "مصنوع من ذهب عيار 22، ويزن 10.23 كجم.", 
            loc: "قاعة توت عنخ آمون (الدور الثاني)", 
            image: "assets/tut_mask.jpg" 
        }
    },
    ramses: {
        en: { 
            title: "The Colossus of Ramses II", 
            desc: "This monumental statue of Ramses II is carved from a single block of red granite and stands at 11 meters in height. It originally stood at the Great Temple of Ptah in Memphis for over 3,000 years before being moved to Cairo in 1955. The statue weighs approximately 83 tons and depicts the king standing with his left foot forward, a traditional pose of power. He wears the white crown of Upper Egypt and a royal kilt with a belt inscribed with his name. His muscular physique represents the strength and military prowess of the Pharaoh who reigned for 66 years. The relocation of this colossus to the G.E.M. was a feat of modern engineering, taking place in 2018. It is now the first major artifact visitors see in the Grand Atrium. The statue is positioned so the sun illuminates its face twice a year, on February 22 and October 22. This alignment mimics the solar phenomenon at the Temple of Abu Simbel. It stands as a eternal tribute to one of Egypt's greatest and most prolific builders.", 
            fact: "It survived for 3,000 years in the ancient capital of Memphis.", 
            loc: "The Grand Atrium", 
            image: "assets/ramses.jpg" 
        },
        ar: { 
            title: "تمثال رمسيس الثاني الضخم", 
            desc: "هذا التمثال الصرحي لرمسيس الثاني منحوت من كتلة واحدة من الجرانيت الأحمر ويبلغ ارتفاعه 11 متراً. وقف في الأصل في معبد بتاح العظيم في منف لأكثر من 3000 عام قبل نقله إلى القاهرة في عام 1955. يزن التمثال حوالي 83 طناً ويصور الملك واقفاً بقدمه اليسرى إلى الأمام، وهو وضع تقليدي يرمز للقوة. يرتدي التاج الأبيض لمصر العليا ومئزراً ملكياً مع حزام منقوش عليه اسمه. يمثل جسده الرياضي القوة والبراعة العسكرية للفرعون الذي حكم لمدة 66 عاماً. كان نقل هذا التمثال الضخم إلى المتحف المصري الكبير إنجازاً هندسياً حديثاً تم في عام 2018. وهو الآن أول قطعة أثرية رئيسية يراها الزوار في البهو العظيم. تم وضع التمثال بحيث تضيء الشمس وجهه مرتين سنوياً، في 22 فبراير و22 أكتوبر. هذا التعامد يحاكي الظاهرة الشمسية في معبد أبو سمبل. يقف التمثال كإشادة أبدية لواحد من أعظم بناة مصر وأكثرهم إنتاجاً.", 
            fact: "نجا لمدة 3000 عام في العاصمة القديمة منف.", 
            loc: "البهو العظيم", 
            image: "assets/ramses.jpg" 
        }
    },
    boat: {
        en: { 
            title: "Khufu’s Solar Boat", 
            desc: "Khufu’s Solar Boat is a 4,500-year-old cedar vessel discovered in 1954 in a pit at the foot of the Great Pyramid. It is 43.6 meters long and was found dismantled into 1,224 individual pieces. Reassembling the boat took over a decade and was completed without the use of a single metal nail. The ancient Egyptians used a sophisticated system of rope-binding to hold the cedar planks together. In Egyptian mythology, solar boats were intended to carry the resurrected king across the sky with the sun god Ra. This vessel features six pairs of oars and two large steering oars at the stern. It is made of high-quality Lebanon cedar, which was highly prized in the Old Kingdom. The ship’s design reveals advanced knowledge of naval architecture and stability. Recently, it was moved from the Giza Plateau to a dedicated building at the G.E.M. This boat is the oldest intact, full-size ship in the world. It provides a rare glimpse into the seafaring capabilities and religious beliefs of the 4th Dynasty.", 
            fact: "It is held together by half a mile of specialized rope.", 
            loc: "Solar Boat Pavilion", 
            image: "assets/boat.jpg" 
        },
        ar: { 
            title: "مركب خوفو الشمسي", 
            desc: "مركب خوفو الشمسي هو سفينة من خشب الأرز عمرها 4500 عام اكتشفت عام 1954 في حفرة عند قدم الهرم الأكبر. يبلغ طوله 43.6 مترًا وعُثر عليه مفككًا إلى 1224 قطعة منفصلة. استغرق إعادة تجميع المركب أكثر من عقد من الزمان وتم ذلك دون استخدام مسمار معدني واحد. استخدم المصريون القدماء نظاماً متطوراً من ربط الحبال لتثبيت ألواح الأرز معاً. في الأساطير المصرية، كان الغرض من المراكب الشمسية حمل الملك المنبعث عبر السماء مع إله الشمس رع. تحتوي هذه السفينة على ستة أزواج من المجاديف ومجذافين كبيرين للتوجيه في المؤخرة. وهي مصنوعة من خشب أرز لبنان عالي الجودة، والذي كان يحظى بتقدير كبير في الدولة القديمة. يكشف تصميم السفينة عن معرفة متقدمة بالهندسة البحرية والاستقرار. مؤخراً، نُقل من هضبة الجيزة إلى مبنى مخصص في المتحف المصري الكبير. هذا المركب هو أقدم سفينة كاملة الحجم وسليمة في العالم. إنه يوفر لمحة نادرة عن القدرات الملاحية والمعتقدات الدينية للأسرة الرابعة.", 
            fact: "يتم تجميعه بواسطة نصف ميل من الحبال المتخصصة.", 
            loc: "مبنى مركب خوفو", 
            image: "assets/boat.jpg" 
        }
    },
    rosetta: {
        en: { 
            title: "The Rosetta Stone", 
            desc: "The Rosetta Stone is the key that unlocked the mystery of hieroglyphics for modern scholars. Discovered in 1799 by French soldiers, it is a stone slab inscribed with a royal decree from 196 BC. The decree is written in three scripts: Hieroglyphic, Demotic, and Ancient Greek. This bilingual nature allowed Jean-François Champollion to finally crack the code of the ancient Egyptian language in 1822. The stone is made of granodiorite and weighs approximately 760 kilograms. It was originally displayed in a temple, but was later used as building material for a fort near the town of Rashid (Rosetta). The text itself is a decree honoring King Ptolemy V Epiphanes. Without this stone, our understanding of Egyptian history, religion, and culture would be extremely limited. It represents a bridge between the ancient world and modern archaeology. The G.E.M. features an extensive exhibit on its history and impact. Visitors can see how the decipherment changed the way we view the Pharaohs forever. It remains one of the most famous and studied objects in the history of linguistics.", 
            fact: "It was discovered by a soldier named Pierre-François Bouchard.", 
            loc: "Hall of Scripts", 
            image: "assets/rosetta.jpg" 
        },
        ar: { 
            title: "حجر رشيد", 
            desc: "حجر رشيد هو المفتاح الذي كشف سر الهيروغليفية للعلماء المعاصرين. اكتشفه الجنود الفرنسيون عام 1799، وهو عبارة عن لوح حجري منقوش عليه مرسوم ملكي من عام 196 قبل الميلاد. كُتب المرسوم بثلاثة خطوط: الهيروغليفية، والديموطيقية، واليونانية القديمة. سمحت هذه الطبيعة ثنائية اللغة لجان فرانسوا شامبليون بفك رموز اللغة المصرية القديمة أخيراً في عام 1822. الحجر مصنوع من الجرانوديوريت ويزن حوالي 760 كيلوجراماً. عُرض في الأصل في معبد، ولكن تم استخدامه لاحقاً كمادة بناء لقلعة بالقرب من مدينة رشيد. النص نفسه هو مرسوم يكرم الملك بطليموس الخامس. بدون هذا الحجر، سيكون فهمنا للتاريخ والدين والثقافة المصرية محدوداً للغاية. إنه يمثل جسراً بين العالم القديم وعلم الآثار الحديث. يضم المتحف المصري الكبير معرضاً واسعاً عن تاريخه وتأثيره. يمكن للزوار رؤية كيف غير فك الرموز الطريقة التي ننظر بها إلى الفراعنة للأبد. ويظل أحد أشهر القطع وأكثرها دراسة في تاريخ اللغويات.", 
            fact: "اكتشفه جندي يدعى بيير فرانسوا بوشار.", 
            loc: "قاعة الكتابة", 
            image: "assets/rosetta.jpg" 
        }
    },
    amenhotep: {
        en: { 
            title: "Statue of Amenhotep III", 
            desc: "Amenhotep III, known as 'The Magnificent,' ruled during the 18th Dynasty at the height of Egyptian power. This massive quartzite statue depicts the Pharaoh in a classic seated position, exuding calm and authority. His reign was a period of unprecedented prosperity and artistic achievement, known as the Golden Age. He commissioned some of the largest monuments in Egypt, including the Colossi of Memnon. Amenhotep III was the father of Akhenaten and the grandfather of Tutankhamun. The statue’s features, including large almond-shaped eyes and a slight smile, became the standard for royal art in his time. It was discovered in the remains of his mortuary temple in Thebes, which was once the largest in Egypt. The use of quartzite, a very hard and difficult stone to carve, demonstrates the skill of his royal sculptors. This piece has been restored to its former glory to stand as a symbol of 18th Dynasty grandeur. It reflects the Pharaoh's status as a living god on earth. In the G.E.M., it serves as a reminder of the wealth and stability that defined his long rule.", 
            fact: "He ruled for 38 years, a time of relative peace and great wealth.", 
            loc: "Grand Hall", 
            image: "assets/amenhotep.jpg" 
        },
        ar: { 
            title: "تمثال أمنحتب الثالث", 
            desc: "حكم أمنحتب الثالث، المعروف باسم 'المذهل'، خلال الأسرة الثامنة عشرة في ذروة القوة المصرية. يصور هذا التمثال الضخم من الكوارتزيت الفرعون في وضعية جلوس كلاسيكية، مما يشع بالهدوء والسلطة. كان عهده فترة من الرخاء غير المسبوق والإنجاز الفني، وعُرف بالعصر الذهبي. كلف ببناء بعض أكبر المعالم الأثرية في مصر، بما في ذلك تمثالي ممنون. كان أمنحتب الثالث والد أخناتون وجد توت عنخ آمون. ملامح التمثال، بما في ذلك العيون الكبيرة على شكل لوز والابتسامة الخفيفة، أصبحت المعيار للفن الملكي في عصره. اكتشف في بقايا معبده الجنائزي في طيبة، والذي كان يوماً الأكبر في مصر. يظهر استخدام الكوارتزيت، وهو حجر صلب للغاية ويصعب نحته، مهارة نحاتيه الملكيين. تم ترميم هذه القطعة إلى مجدها السابق لتقف كرمز لعظمة الأسرة الثامنة عشرة. إنه يعكس مكانة الفرعون كإله حي على الأرض. في المتحف المصري الكبير، يعد بمثابة تذكير بالثروة والاستقرار اللذين ميزا حكمه الطويل.", 
            fact: "حكم لمدة 38 عاماً، وهي فترة تميزت بالسلام النسبي والثروة الكبيرة.", 
            loc: "البهو العظيم", 
            image: "assets/amenhotep.jpg" 
        }
    }
};

let currentLang = 'en';
const bgMusic = document.getElementById('bg-music');
let isMusicPlaying = false;

function toggleMusic() {
    const icon = document.getElementById('mute-icon');
    if (isMusicPlaying) {
        bgMusic.pause();
        icon.src = 'assets/sound_off.png';
    } else {
        bgMusic.play().catch(e => console.log("User must interact first"));
        icon.src = 'assets/sound_on.png';
    }
    isMusicPlaying = !isMusicPlaying;
}

function startExperience() {
    if (!isMusicPlaying) toggleMusic();
}

function setLanguage(lang) {
    currentLang = lang;
    document.body.className = (lang === 'ar') ? 'rtl' : 'ltr';
    const galleryTitle = document.getElementById('gallery-title');
    galleryTitle.innerText = (lang === 'ar') ? "المجموعة الملكية" : "The Royal Collection";
    goToPage('page-gallery');
}

function goToPage(pageId) {
    const sfx = document.getElementById('sfx-whoosh');
    sfx.currentTime = 0;
    sfx.play().catch(e => {});

    const overlay = document.getElementById('transition-overlay');
    const upper = document.querySelector('.jaw-upper');
    const lower = document.querySelector('.jaw-lower');
    const homeBtn = document.getElementById('home-btn');

    homeBtn.style.display = (pageId === 'page-signup' || pageId === 'page-language') ? 'none' : 'block';

    overlay.style.display = 'block';
    // Close Jaws
    setTimeout(() => {
        upper.style.transform = "translateY(0)";
        lower.style.transform = "translateY(0)";
    }, 10);

    // Swap Content & Open Jaws
    setTimeout(() => {
        document.querySelectorAll('.page-screen').forEach(sec => sec.classList.remove('active-page'));
        document.getElementById(pageId).classList.add('active-page');
        upper.style.transform = "translateY(-100%)";
        lower.style.transform = "translateY(100%)";
    }, 1100);

    setTimeout(() => {
        overlay.style.display = 'none';
    }, 2200);
}

function showArtifact(key) {
    const data = artifacts[key][currentLang];
    document.getElementById('detail-title').innerText = data.title;
    document.getElementById('detail-desc').innerText = data.desc;
    document.getElementById('detail-fact').innerText = data.fact;
    document.getElementById('detail-loc').innerText = data.loc;
    document.getElementById('detail-img').src = data.image;
    goToPage('page-details');
}

function toggleChat() {
    const win = document.getElementById('chat-window');
    win.style.display = (win.style.display === 'flex') ? 'none' : 'flex';
}

function handleChat(event) {
    if (event.key === 'Enter') {
        const input = document.getElementById('chat-input');
        const body = document.getElementById('chat-body');
        const text = input.value.toLowerCase().trim();

        if (!text) return;

        body.innerHTML += `<div class="user-msg">${input.value}</div>`;
        input.value = "";

        let reply = (currentLang === 'en') ? "I am deciphering your whisper... Ask about Tut, Ramses, or the Boats." : "أنا أفك رموز همساتك... اسأل عن توت، رمسيس، أو المراكب.";

        const keywords = {
            tut: ["tut", "mask", "gold", "توت", "ذهب", "قناع"],
            ramses: ["ramses", "statue", "colossus", "رمسيس", "تمثال"],
            boat: ["boat", "khufu", "ship", "مركب", "خوفو", "سفينة"],
            gem: ["gem", "museum", "tickets", "price", "تذكرة", "متحف"],
            hello: ["hi", "hello", "greetings", "مرحبا", "أهلا"]
        };

        if (keywords.tut.some(k => text.includes(k))) {
            reply = (currentLang === 'en') ? "Tutankhamun's mask is 11kg of gold! Find it on Level 2." : "قناع توت عنخ آمون وزنه 11 كجم من الذهب! تجده في الدور الثاني.";
        } else if (keywords.ramses.some(k => text.includes(k))) {
            reply = (currentLang === 'en') ? "Ramses II is 11 meters tall. He greets you in the Grand Atrium!" : "تمثال رمسيس طوله 11 متراً. يستقبلك في البهو العظيم!";
        } else if (keywords.boat.some(k => text.includes(k))) {
            reply = (currentLang === 'en') ? "Khufu's Solar Boat is 4,500 years old and built without nails." : "مركب خوفو عمره 4500 عام وبني بدون مسمار واحد.";
        } else if (keywords.gem.some(k => text.includes(k))) {
            reply = (currentLang === 'en') ? "The G.E.M. is the largest archaeological museum in the world." : "المتحف المصري الكبير هو أكبر متحف أثري في العالم.";
        } else if (keywords.hello.some(k => text.includes(k))) {
            reply = (currentLang === 'en') ? "Greetings, explorer. What secrets shall we uncover?" : "مرحباً أيها المستكشف. ما الأسرار التي سنكشفها؟";
        }

        setTimeout(() => {
            body.innerHTML += `<div class="bot-msg">${reply}</div>`;
            body.scrollTop = body.scrollHeight;
        }, 600);
    }
}